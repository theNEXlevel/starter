<ng-container *ngIf="vm$ | async as vm">
  <form [formGroup]="form" (ngSubmit)="submit()">
    <mat-form-field class="full-width" appearance="fill">
      <mat-label>Email</mat-label>
      <input matInput formControlName="email" data-cy="login-email" />
      <mat-error *ngIf="email?.hasError('required') && !email?.hasError('email')" data-cy="email-required">
        Email is required
      </mat-error>
      <mat-error *ngIf="email?.hasError('email')" data-cy="email-pattern"> Email must be valid </mat-error>
    </mat-form-field>
    <mat-form-field class="full-width" appearance="fill">
      <mat-label>Password</mat-label>
      <input matInput formControlName="password" data-cy="login-password" />
      <mat-error *ngIf="password?.hasError('required')" data-cy="password-required"> Password is required </mat-error>
    </mat-form-field>
    <div class="btn-group">
      <button mat-raised-button type="submit" data-cy="login-submit" color="primary" [disabled]="vm.loading">
        <mat-icon *ngIf="!vm.loading">{{ showRegister ? 'person_add' : 'login' }}</mat-icon>
        <mat-spinner [diameter]="24" *ngIf="vm.loading" class="spinner-icon"></mat-spinner>
        {{ showRegister ? 'Create an Account' : 'Login' }}
      </button>
      <button mat-raised-button type="button" (click)="toggleRegister()" class="create-btn" data-cy="register-toggle">
        <mat-icon>{{ showRegister ? 'login' : 'person_add' }}</mat-icon>
        {{ showRegister ? 'Back to Login' : 'Create an Account' }}
      </button>
    </div>
  </form>
</ng-container>
